
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FMC Link Controller &#8212; Open Ephys ONIX  documentation</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/blank.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/copyURLToClipboard.js"></script>
    <script src="https://wavedrom.com/skins/default.js"></script>
    <script src="https://wavedrom.com/wavedrom.min.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="BNO055" href="bno055.html" />
    <link rel="prev" title="FMC Host Clock Output Device" href="fmc-clock-out.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/onix_open_ephys_logo.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../index.html">
  Hardware Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../API%20Reference/index.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../Software%20Guide/index.html">
  Software Guide
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://open-ephys.org">Open Ephys<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/open-ephys/onix-docs" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/openephys" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://open-ephys.slack.com" rel="noopener" target="_blank" title="Slack">
            <span><i class="fab fa-slack"></i></span>
            <label class="sr-only">Slack</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Setup/index.html">
   System Setup
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="simple">
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../PCIe%20Host/index.html">
   PCIe Host
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../PCIe%20Host/overview.html">
     Overview
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../PCIe%20Host/setup-windows.html">
     Setup Guide for Windows
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../PCIe%20Host/gateware-drivers.html">
     Gateware and Device Drivers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../PCIe%20Host/multi-board-sync.html">
     Synchronizing Multiple PCIe Hosts
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Breakout%20Board/index.html">
   Breakout Board
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Breakout%20Board/overview.html">
     Overview
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Breakout%20Board/setup.html">
     Setup
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Headstages/index.html">
   Headstages
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Headstages/serialization.html">
     Coaxial Data Serialization &amp; Power
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Headstages/tethers.html">
     Making Coaxial Tethers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Headstages/commutators.html">
     Coaxial Headstage Commutators
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../Headstages/headstage-64/index.html">
     Headstage-64
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../Headstages/headstage-64/test-board-64.html">
       Test Board for Headstage-64
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Headstages/headstage-neuropix.html">
     Neuropixels-1.0 Headstage
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Miniscopes/index.html">
   Miniscopes
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Adapters%20%26%20EIBs/index.html">
   Adapters &amp; EIBs
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Adapters%20%26%20EIBs/eib-64.html">
     EIB-64
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Adapters%20%26%20EIBs/eib-64-large.html">
     EIB-64L
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Adapters%20%26%20EIBs/omnetics-adapter-64.html">
     64-Channel Omnetics Adpater
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Adapters%20%26%20EIBs/nano-z-adapter-64.html">
     64-Channel Nano-Z Adapter
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   ONI Datasheets
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="heartbeat.html">
     Heartbeat
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="load-test.html">
     Load Test Device
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="memory-usage.html">
     Memory Usage Monitor
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="fmc-analog-io.html">
     FMC Host Analog IO Device
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="fmc-digital-io.html">
     FMC Host Digital IO Device
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="fmc-clock-out.html">
     FMC Host Clock Output Device
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     FMC Link Controller
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="bno055.html">
     BNO055
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="rhd2164.html">
     RHD2164
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="estim-hs64.html">
     HS64 Electrical Stimulator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ostim-hs64.html">
     HS64 Optical Stimulator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ts4231-v1-array.html">
     TS4231 Array for V1 Base Stations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="neuropixels-v1.html">
     Neuropixels V1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ds90ub9x-raw.html">
     DS90UB9X Raw Device
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#description">
   Description
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#register-programming">
   Register Programming
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#device-to-host-data-frames">
   Device To Host Data Frames
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#host-to-device-data-frames">
   Host To Device Data Frames
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                

<div class="tocsection editthispage">
    <a href="https://github.com/open-ephys/onix-docs/edit/main/source/Hardware Guide/Datasheets/fmc-link-control.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="fmc-link-controller">
<span id="onidatasheet-fmc-link-control"></span><h1>FMC Link Controller<a class="headerlink" href="#fmc-link-controller" title="Permalink to this headline">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Authors</dt>
<dd class="field-odd"><p>Jonathan P. Newman</p>
</dd>
<dt class="field-even">IO</dt>
<dd class="field-even"><p>Frame Source, Register Access</p>
</dd>
<dt class="field-odd">ONIX ID</dt>
<dd class="field-odd"><p>23</p>
</dd>
<dt class="field-even">ONIX Hubs</dt>
<dd class="field-even"><p><a class="reference internal" href="../PCIe%20Host/index.html#pcie-host"><span class="std std-ref">PCIe Host</span></a></p>
</dd>
</dl>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>The <strong>FMC Host Link Controller</strong> is used to control and monitor DS90UB9x-based
serialized connections to hubs connected to a host such as headstages and
miniscopes. It can control power provided to those hubs and receives RF lock,
CRC error, and other information.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Typical inplementaitons will default link voltages to 0. Often the link
will need to be manually activated via the appropriate registers in order
for a headstage to be used.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The maximum DC voltage that can be produced by this device may exceed the
absolute maximum ratings for some headstages. Although they typically will
have some form input overvoltage protection, the user should be careful to
keep the voltage within a functional range.</p>
</div>
</div>
<div class="section" id="register-programming">
<span id="onidatasheet-fmc-link-control-reg"></span><h2>Register Programming<a class="headerlink" href="#register-programming" title="Permalink to this headline">¶</a></h2>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Address</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Time of Effect</p></th>
<th class="head"><p>POR Value</p></th>
<th class="head"><p>Reset Action</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x00</p></td>
<td><p>ENABLE</p></td>
<td><p>R/W</p></td>
<td><p>On Reset</p></td>
<td><p>Implementation dependent, see hub documentation</p></td>
<td><p>None</p></td>
<td><p>The LSB is used to enable or disable the device data stream:</p>
<blockquote>
<div><ul class="simple">
<li><p>0x0: data output disabled</p></li>
<li><p>0x1: data output enabled</p></li>
</ul>
</div></blockquote>
</td>
</tr>
<tr class="row-odd"><td><p>0x01</p></td>
<td><p>GPOSTATE</p></td>
<td><p>R/W</p></td>
<td><p>Immediate</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>GPO output state (bits 31 downto 3: ignore. bits 2 downto 0: ‘1’ = high, ‘0’ = low)</p></td>
</tr>
<tr class="row-even"><td><p>0x02</p></td>
<td><p>DESPWR</p></td>
<td><p>R/W</p></td>
<td><p>Immediate</p></td>
<td><p>1</p></td>
<td><p>None</p></td>
<td><p>Set link deserializer PDB state, 0 = deserializer power off else on.
Does not affect port voltage.</p></td>
</tr>
<tr class="row-odd"><td><p>0x03</p></td>
<td><p>PORTVOLTAGE</p></td>
<td><p>R/W</p></td>
<td><p>Immediate</p></td>
<td><p>EEPROM*</p></td>
<td><p>None</p></td>
<td><p>10 * link voltage. Valid values:</p>
<blockquote>
<div><ul class="simple">
<li><p>000         :  Turn off</p></li>
<li><p>001         :  3.3 volts (min)</p></li>
<li><p>…         :  3.3 volts (min)</p></li>
<li><p>032         :  3.3 volts (min)</p></li>
<li><p>033         :  3.3 volts (min)</p></li>
<li><p>034         :  3.4 volts</p></li>
<li><p>035         :  3.5 volts</p></li>
<li><p>…         :  …</p></li>
<li><p>108         : 10.8 volts</p></li>
<li><p>109         : 10.9 volts</p></li>
<li><p>110         : 11.0 volts (max)</p></li>
<li><p>111         : 11.0 volts (max)</p></li>
<li><p>…         : 11.0 volts (max)</p></li>
</ul>
</div></blockquote>
</td>
</tr>
<tr class="row-even"><td><p>0x04</p></td>
<td><p>SAVEVOLTAGE</p></td>
<td><p>W</p></td>
<td><p>Immediate</p></td>
<td><p>EEPROM*</p></td>
<td><p>None</p></td>
<td><p>Save link voltage to non-volatile EEPROM if greater than 0. This
voltage will be applied after POR.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="device-to-host-data-frames">
<span id="onidatasheet-fmc-link-control-d2h"></span><h2>Device To Host Data Frames<a class="headerlink" href="#device-to-host-data-frames" title="Permalink to this headline">¶</a></h2>
<p>Each frame transmitted to the host is structured as follows:</p>

<div style="overflow-x:auto">
<script type="WaveDrom">
{
    reg: [
      {bits: 64, name: "Acquisition Clock Counter", type: 0},
      {bits: 32, name: "Device Address", type: 0},
      {bits: 32, name: "Data Size", type: 0, attr: 10},

      {bits: 64, name: "Hub Clock Counter", type: 3},

      {bits: 8, name: "Status Codeword", type: 4},

      {bits: 5, name: "Reserved"},

      {bits: 1, name: "CV", type: 2},
      {bits: 1, name: "PP", type: 2},
      {bits: 1, name: "SL", type: 2},

      {bits: 16}

    ],
    config: {bits: 224, lanes: 7, vflip: true, hflip: true, fontsize: 11}
}
</script>
</div>
<p>This device produces frames when triggered by the <strong>CV</strong>, <strong>PP</strong>, or <strong>SL</strong>
bits. These are defined as follows:</p>
<blockquote>
<div><dl>
<dt>CV</dt><dd><p>Codeword valid. Indicates that the Status Codeword field has valid data.
A frame is produced when this bit goes high. The codeword meaning is
hub-dependent. See hub documentation for definitions.</p>
</dd>
<dt>PP</dt><dd><p>Parity check pass. This bit reflects the state of the PASS pin on the
DS90UB9x4 deserializer.</p>
<blockquote>
<div><ul class="simple">
<li><p>0b0: One or more errors were detected in the received payload.</p></li>
<li><p>0b1: Error free transmission in forward channel operation.</p></li>
</ul>
</div></blockquote>
<p>A frame is produced whenever this bit changes state.</p>
</dd>
<dt>SL</dt><dd><p>SERDES lock. This bit reflects the state of the LOCK pin on the DS90UB9x4
deserializer, which monitors the lock status of FPD-Link III channel.</p>
<blockquote>
<div><ul class="simple">
<li><p>0b0: PLL is unlocked link is down.</p></li>
<li><p>0b1: PLL is locked, link is active.</p></li>
</ul>
</div></blockquote>
<p>A frame is produced whenever this bit changes state.</p>
</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="host-to-device-data-frames">
<h2>Host To Device Data Frames<a class="headerlink" href="#host-to-device-data-frames" title="Permalink to this headline">¶</a></h2>
<p>This device does not accept input frames. All write attempts will fail with an
error.</p>
</div>
</div>

    <script type="text/javascript">
        function init() {
            WaveDrom.ProcessAll();
        }
        window.onload = init;
    </script>

              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="fmc-clock-out.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">FMC Host Clock Output Device</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="bno055.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">BNO055</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2010-2021, Open Ephys &amp; Contributors.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>