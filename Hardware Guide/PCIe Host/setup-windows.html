
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Setup Guide for Windows &#8212; Open Ephys ONIX  documentation</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/blank.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/copyURLToClipboard.js"></script>
    <script src="https://wavedrom.com/skins/default.js"></script>
    <script src="https://wavedrom.com/wavedrom.min.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Gateware and Device Drivers" href="gateware-drivers.html" />
    <link rel="prev" title="Overview" href="overview.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/onix_open_ephys_logo.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../index.html">
  Hardware Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../API%20Reference/index.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../Software%20Guide/index.html">
  Software Guide
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://open-ephys.org">Open Ephys<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/open-ephys/onix-docs" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/openephys" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://open-ephys.slack.com" rel="noopener" target="_blank" title="Slack">
            <span><i class="fab fa-slack"></i></span>
            <label class="sr-only">Slack</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Setup/index.html">
   Hardware System Setup
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="simple">
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   PCIe Host
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="overview.html">
     Overview
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Setup Guide for Windows
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="gateware-drivers.html">
     Gateware and Device Drivers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="multi-board-sync.html">
     Synchronizing Multiple PCIe Hosts
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Breakout%20Board/index.html">
   Breakout Board
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Breakout%20Board/overview.html">
     Overview
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Breakout%20Board/setup.html">
     Setup
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Headstages/index.html">
   Headstages
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Headstages/serialization.html">
     Coaxial Data Serialization &amp; Power
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Headstages/tethers.html">
     Making Coaxial Tethers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Headstages/commutators.html">
     Coaxial Headstage Commutators
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../Headstages/headstage-64/index.html">
     Headstage-64
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../Headstages/headstage-64/test-board-64.html">
       Test Board for Headstage-64
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Headstages/headstage-neuropix.html">
     Neuropixels-1.0 Headstage
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Miniscopes/index.html">
   Miniscopes
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Adapters%20%26%20EIBs/index.html">
   Adapters &amp; EIBs
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Adapters%20%26%20EIBs/eib-64.html">
     EIB-64
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Adapters%20%26%20EIBs/eib-64-large.html">
     EIB-64L
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Adapters%20%26%20EIBs/omnetics-adapter-64.html">
     64-Channel Omnetics Adpater
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Adapters%20%26%20EIBs/nano-z-adapter-64.html">
     64-Channel Nano-Z Adapter
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Datasheets/index.html">
   ONI Datasheets
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Datasheets/heartbeat.html">
     Heartbeat
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Datasheets/load-test.html">
     Load Test Device
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Datasheets/memory-usage.html">
     Memory Usage Monitor
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Datasheets/fmc-analog-io.html">
     FMC Host Analog IO Device
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Datasheets/fmc-digital-io.html">
     FMC Host Digital IO Device
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Datasheets/fmc-clock-out.html">
     FMC Host Clock Output Device
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Datasheets/fmc-link-control.html">
     FMC Link Controller
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Datasheets/bno055.html">
     BNO055
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Datasheets/rhd2164.html">
     RHD2164
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Datasheets/estim-hs64.html">
     HS64 Electrical Stimulator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Datasheets/ostim-hs64.html">
     HS64 Optical Stimulator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Datasheets/ts4231-v1-array.html">
     TS4231 Array for V1 Base Stations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Datasheets/neuropixels-v1.html">
     Neuropixels V1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Datasheets/ds90ub9x-raw.html">
     DS90UB9X Raw Device
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#insert-the-pcie-host-module">
   Insert the PCIe Host Module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#put-windows-in-testing-mode">
   Put Windows In Testing Mode
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#install-c-runtime">
   Install C++ Runtime
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#install-device-driver">
   Install Device Driver
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#install-onix-bonsai-library">
   Install ONIX Bonsai Library
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                

<div class="tocsection editthispage">
    <a href="https://github.com/open-ephys/onix-docs/edit/main/source/Hardware Guide/PCIe Host/setup-windows.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="setup-guide-for-windows">
<span id="pcie-host-setup-windows"></span><h1>Setup Guide for Windows<a class="headerlink" href="#setup-guide-for-windows" title="Permalink to this headline">¶</a></h1>
<div class="section" id="insert-the-pcie-host-module">
<h2>Insert the PCIe Host Module<a class="headerlink" href="#insert-the-pcie-host-module" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p>Power off the computer.</p></li>
<li><p>Plug the PCIe host board into an available PCIe slot</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You do not need to plug the ATX power supply into connector on
the board (although doing so won’t hurt). The PCIe slot itself provides
adequate power to operate the host board.</p>
</div>
</li>
<li><p>Boot the computer.</p></li>
<li><p>The RGB LED in the center of the module should be blue.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The RGB LED has three color states.</p>
<ul class="simple">
<li><p>Blue: Ready to go.</p></li>
<li><p>Yellow: Acquisition stopped.</p></li>
<li><p>Pink: Acquisition running.</p></li>
</ul>
</div>
</li>
</ol>
</div>
<div class="section" id="put-windows-in-testing-mode">
<h2>Put Windows In Testing Mode<a class="headerlink" href="#put-windows-in-testing-mode" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As of this writing, the ONIX driver is not digitally signed by
Microsoft, but in a developer testing phase. Following the conclusion of the
beta-test period, we will complete this process and the following steps
will not be required.</p>
</div>
<ol class="arabic">
<li><p>Download the <a class="reference download internal" download="" href="../../_downloads/03c81562bec3fe6a9a4c0a7786acb870/OpenEphysTestDriver.cer"><code class="xref download docutils literal notranslate"><span class="pre">OpenEphysTestDriver.cer</span></code></a> testing certificate and double
click it.</p></li>
<li><p>On the dialog, select <strong>Install Certificate</strong>.</p>
<div class="figure align-left">
<img alt="../../_images/install-certificate.png" src="../../_images/install-certificate.png" />
</div>
</li>
<li><p>It is recommended to select <strong>Current User</strong> certificate storage option.</p>
<div class="figure align-left">
<img alt="../../_images/certificate-import-current-user.png" src="../../_images/certificate-import-current-user.png" />
</div>
</li>
<li><p>For ease of management, it is recommended to manually select a certificate
storage and chose <strong>Personal</strong>.</p>
<div class="figure align-left">
<img alt="../../_images/certificate-import-personal-storage.png" src="../../_images/certificate-import-personal-storage.png" />
</div>
</li>
<li><p>Open the Windows Start Menu and type <strong>cmd</strong> to find the command prompt
application. Right click it and chose <strong>Run as Administrator</strong>.</p>
<div class="figure align-left">
<img alt="../../_images/cmd-run-as-admin.png" src="../../_images/cmd-run-as-admin.png" />
</div>
</li>
<li><p>Execute the following command: <code class="docutils literal notranslate"><span class="pre">bcdedit</span> <span class="pre">/set</span> <span class="pre">testsigning</span> <span class="pre">on</span></code></p>
<div class="figure align-left">
<img alt="../../_images/windows-test-mode-command.png" src="../../_images/windows-test-mode-command.png" />
</div>
</li>
<li><p>Restart the computer.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A regular reboot is required. A complete power cycle might not set
the option.</p>
</div>
</li>
<li><p>You should see now some text at the bottom right of the Desktop indicating
that Windows is operating in testing mode:</p>
<div class="figure align-left">
<img alt="../../_images/windows-test-mode-text.png" src="../../_images/windows-test-mode-text.png" />
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The computer will keep the test state until you run <code class="docutils literal notranslate"><span class="pre">bcdedit</span> <span class="pre">/set</span>
<span class="pre">testsigning</span> <span class="pre">off</span></code> in an administrator command prompt again and reboot the
computer</p>
</div>
</li>
</ol>
</div>
<div class="section" id="install-c-runtime">
<h2>Install C++ Runtime<a class="headerlink" href="#install-c-runtime" title="Permalink to this headline">¶</a></h2>
<p>Windows does not ship with a C++ runtime. Before using ONIX on windows, you
will need to install <a class="reference external" href="https://aka.ms/vs/16/release/vc_redist.x64.exe">Microsoft Visual C++ Redistributable for Visual Studio
2015, 2017 and 2019</a>.</p>
</div>
<div class="section" id="install-device-driver">
<h2>Install Device Driver<a class="headerlink" href="#install-device-driver" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Pre-built drivers target 64-bit Windows 10. Other targets will
need to be compiled from source.</p>
</div>
<ol class="arabic">
<li><p>Download <a class="reference download internal" download="" href="../../_downloads/0a8646f7fbf5491fffedf38bbc22fecd/riffa-driver.zip"><code class="xref download docutils literal notranslate"><span class="pre">riffa</span> <span class="pre">driver</span></code></a> and unzip the archive.</p></li>
<li><p>Open the folder and right right click the <strong>riffa.inf</strong> file.
Select <strong>install</strong> from the context menu.</p></li>
<li><p>Open the start menu and type <strong>device manager</strong> and click to open. You shoul
see <strong>RIFFA</strong> in the device tree.</p>
<div class="figure align-left">
<img alt="../../_images/package-manager-riffa.png" src="../../_images/package-manager-riffa.png" />
</div>
</li>
</ol>
</div>
<div class="section" id="install-onix-bonsai-library">
<h2>Install ONIX Bonsai Library<a class="headerlink" href="#install-onix-bonsai-library" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p>If you don’t have Bonsai on your computer, visit <a class="reference external" href="https://bonsai-rx.org/">https://bonsai-rx.org/</a> and
install the latest release.</p></li>
<li><p>Open Bonsai. At the start menu, select <strong>Manage Packages</strong>.</p>
<div class="figure align-left">
<img alt="../../_images/bonsai-start-menu.png" src="../../_images/bonsai-start-menu.png" />
</div>
</li>
<li><p>Select <strong>Community Packages</strong> as the package source.</p></li>
<li><p>Search for <strong>Bonsai.ONIX</strong>.</p></li>
<li><p>Install <strong>Bonsai.ONIX.Design</strong>. This packages will install both the core
library and visualization tools.</p></li>
<li><p>Have a look at the <a class="reference internal" href="../../Software%20Guide/Bonsai/index.html#bonsai-onixref"><span class="std std-ref">Bonsai</span></a> for usage instructions
and example scripts.</p></li>
</ol>
</div>
</div>

    <script type="text/javascript">
        function init() {
            WaveDrom.ProcessAll();
        }
        window.onload = init;
    </script>

              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="overview.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Overview</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="gateware-drivers.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Gateware and Device Drivers</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2010-2022, Open Ephys &amp; Contributors.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>